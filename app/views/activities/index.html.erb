<div class='middle-display'>
  <h2>Here are some activities to choose from</h2>

  <%= search_form_for @search do |activity| %>
    <ul>
      <li><%= activity.label :name_cont, "Search by Name" %>
        <%= activity.text_field :name_cont %></li>
      <li><%= activity.label :description_cont, "Search by Description" %>
        <%= activity.text_field :description_cont %></li>
      <li><%= activity.label :activity_category_id_eq, "Filter by Category" %>
        <%= activity.select :activity_category_id_eq, options_from_collection_for_select(ActivityCategory.all, :id, :activity_category), 
        :include_blank => 'Please Select' %></li>
      <li><%= activity.submit "Submit" %></li>
      <li><%= link_to 'Clear Search', activities_path %>
    </ul>
  <% end %>

  <table id="activity_table">
    <th>Activity Name</th>
    <th>Category</th>
    <th>Description</th>
    <% @activities.each do |activity| %>
      <tr id="activity_id_<%= activity.id %>">
        <td><%= link_to activity.name, activity_path(activity) %></td>
        <td><%= activity.activity_category.activity_category %></td>
        <td><%= activity.description %></td>
        <%- if family_account_signed_in? -%>
          <%- current_family_account.child_accounts.each do |account| -%>
            <%= simple_form_for [account, account.favorite_activities.build] do |fav_activity| %>
              <%= fav_activity.hidden_field :name, value: activity.name %>
              <%= fav_activity.hidden_field :activity_category_id, value: activity.activity_category_id %>
              <%= fav_activity.hidden_field :description, value: activity.description %>
              <td><%= fav_activity.submit "Add to #{account.username}'s Favorites" %></td>
            <%- end -%>
          <%- end -%>
        <%- else -%>  
          <%= link_to 'Add to Favorites', new_family_account_session_path %>
        <%- end -%>
      </tr>
    <%end %>
  </table>

<%- if false -%>
<% if family_account_signed_in? %>
          <% current_family_account.child_accounts.each do |account| %>
            <%= form_for [account, account.favorite_foods.build] do |f| %>
              <%= f.hidden_field :name, value: food.name %>
              <%= f.hidden_field :food_category_id, value: food.food_category_id %>
              <%= f.hidden_field :food_type_id, value: food.food_type_id %>
              <td><%= f.submit "Add to #{account.username}'s Favorites" %></td>
            <% end %>
          <% end %>
        <% else %>
        <td><%= link_to 'Add to Favorites', new_family_account_session_path, class: 'submit-button' %></td>
        <% end %>
<%- end -%>






  <% if family_account_signed_in? %>
    <% current_family_account.child_accounts.each do |child_account| %>
      <%= link_to "Check Out #{child_account.username}'s Favorites", 
        child_account_favorite_activities_path(child_account), class: 'submit-button' %>
    <% end %>
  <% end %>
</div>
